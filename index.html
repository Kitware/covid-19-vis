<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="user-scalable=no">
  <link rel="icon" href="data:,">
  <title>
    COVID-19 Visualizer
  </title>
  <script type="text/javascript" src="polybool.min.js"></script>
  <script type="text/javascript" src="geo.min.js"></script>
  <!-- d3 has to be after geojs, as geojs bundles an older version -->
  <script type="text/javascript" src="https://unpkg.com/d3@5.15.1/dist/d3.min.js"></script>
  <script type="text/javascript" src="https://unpkg.com/c3@0.7.15/c3.js"></script>
  <script type="text/javascript" src="https://unpkg.com/underscore@1.10.2/underscore-min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/c3@0.7.15/c3.min.css" type="text/css"/>
  <link rel="stylesheet" href="main.css" type="text/css"/>
  <link href="https://fonts.googleapis.com/css2?family=Blinker:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>
  <div id="map"></div>
  <div class="top-controls">
    <div id="disclaimer" class="control">
      <div class="panel">
        <button class="help" onclick="$('#help').toggleClass('hidden')">Info</button>
        <h1 class="title">COVID-19 Visualizer</h1>
        <span class="note">Markers are randomly placed in each county and DO NOT represent specific people or real locations.</span>
      </div>
    </div>
    <div id="timeline" class="control">
      <div class="speed" title="Maximum frames-per-second of playback, limited to browser performance">
        <label>fps</label> <input id="speed" value="1" onchange="if(playing)playAction('play')"/>
      </div>
      <div class="playback-controls">
        <button onclick="playAction('play')">
          <span class="iconify" data-icon="mdi:play"></span>
        </button>
        <button onclick="playAction('step')">
          <span class="iconify" data-icon="mdi:step-forward"></span>
        </button>
        <button onclick="playAction('stop')">
          <span class="iconify" data-icon="mdi:stop"></span>
        </button>
      </div>
      <div class="scrubber">
        <input id="scrubber" type="range" min="0" value="0" oninput="setTime('#scrubber', true)"></input>
        <input id="curtime" onchange="setTime()" />
      </div>
      <div class="marker-controls">
        <label class="marker-checkbox" for="markers">
          <input id="markers" type="checkbox" checked="true" onchange="dotLayer.visible($('#markers')[0].checked).draw()"></input><span>Markers</span>
        </label>
        <label class="marker-checkbox" for="county_confirmed">
          <input id="county_confirmed" type="checkbox" onchange="countyLayer.features()[2].visible($('#county_confirmed')[0].checked).draw()"></input><span>Confirmed</span>
        </label>
        <label class="marker-checkbox" for="county_deaths">
          <input id="county_deaths" type="checkbox" onchange="countyLayer.features()[3].visible($('#county_deaths')[0].checked).draw()"></input><span>Deaths</span>
        </label>
      </div>
      <!--
      <input id="samples" type="checkbox" onchange="makeDots()"></input><label for="samples">Samples</label>
      <label for="sampling" title="There is one dot per this many people">Sampling</label> <input id="sampling" value="2500" title="2500" type="range" min="500" max="10000" step="500" onchange="makeDots();$('#sampling').attr('title', $('#sampling').val())"/>
      -->
    </div>
  </div>
  <div id="graphparent" class="control">
    <div class="panel no-pad">
      <ul class="radio-controls">
        <label for="mode1">
          <input type="radio" name="mode" id="mode1" value="total"
          charttitle="Total Confirmed Cases and Deaths"
          onclick="changeMode(this)" checked>
          <span>Total cases</span>
        </label>
        <label for="mode3">
          <input type="radio" name="mode" id="mode3"
          charttitle="Logarithmic Total Confirmed Cases and Deaths"
          value="logtotal" onclick="changeMode(this)">
          <span>Total cases (logarithm)</span>
        </label>
        <label for="mode5">
          <input type="radio" name="mode" id="mode5"
          charttitle="Total Confirmed Cases and Deaths per Million People"
          value="percapitatotal" onclick="changeMode(this)">
          <span>Total per capita</span>
        </label>
        <label for="mode2">
          <input type="radio" name="mode" id="mode2"
          charttitle="Daily Confirmed Cases and Deaths"
          value="daily" onclick="changeMode(this)">
          <span>Daily cases</span>
        </label>
        <!--
        <label for="mode4">
          <input type="radio" name="mode" id="mode4"
          charttitle="Logarithmic Daily Confirmed Cases and Deaths"
          value="logdaily" onclick="changeMode(this)">
          <span>Daily cases (logarithm)</span>
        </label>
        -->
        <label for="mode6">
          <input type="radio" name="mode" id="mode6"
          charttitle="Daily Confirmed Cases and Deaths per Million People"
          value="percapitadaily" onclick="changeMode(this)">
          <span>Daily per capita</span>
        </label>
      </ul>
    </div>
    <div id="graph"></div>
  </div>
  <div id="help" class="hidden" onclick="$('#help').toggleClass('hidden', true)">
    <div id="helpcontainer" onclick="event.stopPropagation()">
      <h1>COVID-19 Visualizer</h1>
      <p>This shows confirmed cases and deaths, as reported by the <a href="https://github.com/CSSEGISandData/COVID-19">2019 Novel Coronavirus COVID-19 (2019-nCoV) Data Repository by Johns Hopkins CSSE</a>.</p>
      <p>The data is per county in the US.
        When showing markers, markers are distributed randomly through each county based on the number present.  These markers <b>do not represent actual people or locations</b>.</p>
      <h2>Modes</h2>
      <p><b>Markers</b>: One marker is drawn per confirmed case (yellow) or death (red).  Markers are randomly distributed within the county for which they are reported.  These do not represent specific people or locations; distribution is only to provide relative densities of cases.</p>
      <p><b>Confirmed</b>: Each county is colored based on the number of confirmed cases per capita, with the county with the most extreme value being solid yellow.</p>
      <p><b>Deaths</b>: Each county is colored based on the number of deaths per capita, with the county with the most extreme value being solid red.</p>
      <h2>Graph</h2>
      <p>Click on the legend of the graph to show or hide a line.</p>
      <p>The graph data is based on the counties on the visible map.  Zooming or panning the map will adjust the graph.  Values include all visible counties, with partially visible counties included proportionate to their visible area.</p>
      <h2>Source Code</h2>
      <p>The source code is on <a href="https://github.com/Kitware/covid-19-vis">GitHub</a>.</p>
      <p>The map markers and choropleth use <a href="https://github.com/OpenGeoscience/geojs">GeoJS</a>.</p>
      <div><button onclick="$('#help').toggleClass('hidden')">Close</burron></div>
    </div>
  </div>
  <script type="text/javascript" src="main.js"></script>
  <script src="https://code.iconify.design/1/1.0.5/iconify.min.js"></script>
</body>
</html>
